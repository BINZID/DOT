<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<!--
    Title:控制台首页
    Description：控制台首页
    Author：WangTianshan (王天山)
    Created date: 2017/9/15 21:35
    Copyright: The Research Group of Biodiversity Informatics (BiodInfo Group) - 中国科学院动物研究所生物多样性信息学研究组
    Version: Html5
 -->
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <title th:text="#{web_title}">D-TAXON&nbsp;物种数据采集系统</title>
    <link rel="shortcut icon" th:href="@{/img/logo.png}" href="/images/logo.png" type="images/x-icon"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content=""/>
    <!-- 引入css -->
    <span th:replace="pageFrame/basicsCss :: copy" />
</head>
<body class="hold-transition skin-leaf fixed layout-top-nav">
<!-- Site wrapper -->
<div class="">
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Main content -->
        <section class="content">
            <div class="register-box">
                <div class="register-logo">
                   	 <span>D-<b>TAXON</b></span>
                </div>
                <div th:if="${#lists.isEmpty(session.SPRING_SECURITY_CONTEXT)}" class="register-box-body">
                    <p class="login-box-msg">忘记密码</p>
                    <form id="forgot_form" th:action="@{/password/sendEmail}" action="password/sendEmail" method="post">
                        <input id="errorMsg" th:value="${errorMsg}" class="hidden" readonly="readonly"></input>
                        <div class="form-group has-feedback">
                            <input id="email" name="email" type="text" class="form-control" placeholder="邮箱，用来激活和找回密码" th:value="${email}">
                            <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
                        </div>
                        
                        <div class="form-group has-feedback">
			                <input type="text" class="form-control" id="token" name="token" autocomplete="off" placeholder="输入下方验证码">
			                <span class="glyphicon glyphicon-barcode form-control-feedback"></span>
			                <p></p>
			                <div>
			                    <i>
			                        <img style="height:32px;" id="codeImg" alt="点击更换" title="点击更换" th:src="@{/captchaImg}"/>
			                        <a href="javascript:void(0);" onclick="reImg()">看不清，换一张</a>
			                    </i>
			                </div>
			            </div>
                        
                        <div class="col-md-12">
                            <div class="form-group pull-right">
                                <button type="submit" class="btn btn-primary btn-block btn-flat" disabled="disabled">提交</button>
                            </div>
                        </div>
                        <div class="row">
                        </div>
                    </form>
                </div>

                <div th:if="${not #lists.isEmpty(session.SPRING_SECURITY_CONTEXT)}" class="register-box-body">
                    <p class="login-box-msg">register_login</p>
                    <div class="social-auth-links text-center">
                        <a href="#" data-toggle="modal" data-target="#modal-logout" class="text-center">注销</a>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- <footer class="">
        <span th:replace="pageFrame/basicsFooter :: copy" />
    </footer> -->
    <!-- Control Sidebar -->
    <!-- <span th:replace="pageFrame/basicsControl :: copy" /> -->
    <!-- <div class="control-sidebar-bg"></div> -->
</div>
<!-- 引入js【body末尾引入js文件会使页面加载更快】 -->
<span th:replace="pageFrame/basicsJs :: copy" />

<div th:if="${#lists.isEmpty(session.SPRING_SECURITY_CONTEXT)}">
    <span th:replace="user/loginJs :: copy" />
	<!-- bootstrapValidator -->
	<script th:src="@{/plugins/bootstrapValidator/js/bootstrapValidator.min.js}"></script>
	<script th:src="@{/plugins/bootstrapValidator/js/language/zh_CN.js}"></script>
</div>
<script th:inline="javascript">
    /*<![CDATA[*/
    var warning_Illegal= [[#{warning_Illegal}]];
    /*]]>*/
</script>
<script>
	function reImg() {
	    var img = document.getElementById("codeImg");
	    img.src = "captchaImg";
	    document.getElementById('codeImg').src = '/captchaImg?code=' + Math.random();
	}
</script>
<script>
	$(document).ready(function() {
        //错误提示
        if($('#errorMsg').val().length>0)
            layer.msg($('#errorMsg').val(), function(){
            });
        //获取host
        $("#base_url").val(window.location.host);
        $('#forgot_form').bootstrapValidator({
            message: 'This value is not valid',
            feedbackIcons: {
                valid: 'glyphicon ',
                invalid: 'glyphicon ',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                email: {
                    validators: {
                    	notEmpty: {
                        },
                        emailAddress: {
                        },
                        stringLength: {
                            min: 6,
                            max: 70,
                        }
                    }
                },
                token: {
                    selector: '#token',
                    validators: {
                        notEmpty: {
                        },
                        stringLength: {
                            min: 4,
                            max: 4,
                        },
                        regexp: {
                            regexp: /^[a-zA-Z0-9_\.]+$/,
                            message: warning_Illegal
                        },
                    }
                },
            }
        });
    });
</script>
<script>
    $("#forgot_form").submit(function(e){
        if($("#forgot_form").data('bootstrapValidator').isValid()){
            layer.load(2);
        }
    });
</script>
</body>
</html>